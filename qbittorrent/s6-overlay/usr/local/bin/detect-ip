#!/bin/bash

if [[ $MONITOR_IP ]]; then
    alter_limits_switch=off
    for ip in $MONITOR_IP; do
        ping -c 2 $ip &>/dev/null
        if [[ $? -eq 0 ]]; then
            alter_limits_switch=on
            break
        fi
    done

    if [[ $alter_limits_switch == on ]]; then
        alter-limits on
    elif [[ $alter_limits_switch == off ]]; then
        alter-limits off
    fi
else
    echo "未设置 MONITOR_IP 环境变量，退出"
    exit 1
fi